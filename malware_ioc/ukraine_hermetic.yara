 rule ukraine_hermetic
 {
	meta:
		last_modified = "15-03-2022"
		description = "ukraine_hermetic YARA Rule (MD5, SHA-1, SHA-256)"
		refer = "https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/"
	
	strings:
		/* HermeticWiper */
		//SHA-256
    //com.exe
		$H1 = 912342F1C840A42F6B74132F8A7C4FFE7D40FB77
    //conhosts.exe
		$H2 = 61B25D11392172E587D8DA3045812A66C3385451

		/* HermeticWizard*/
		//SHA-256
    //c9EEAF78C9A12.dat
		$H3 = 3C54C9A49A8DDCA02189FE15FEA52FE24F41A86F

		/* HermeticRansom */
		//SHA-256
    //cc2.exe
		$H5 = F32D791EC9E6385A91B45942C230F52AFF1626DF
    
		/* IsaacWiper */
		//SHA-256
    //cl64.dll
		$I1 = AD602039C6F0237D4A997D5640E92CE5E2B3BBA3
    //cld.dll
		$I2 = 736A4CFAD1ED83A6A0B75B0474D5E01A3A36F950
    //clean.exe
		$I2 = E9B96E9B86FAD28D950CA428879168E0894D854F

		/* Lateral Movement */
		// Command
    //cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\temp\sys.tmp1 CSIDL_WINDOWS\policydefinitions\postgresql.exe 1> \\127.0.0.1\ADMIN$\__1636727589.6007507 2>&1
		$C1 = "\\\\127.0.0.1\\ADMIN$\\" ascii
    //cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\temp\sys.tmp1 CSIDL_WINDOWS\policydefinitions\postgresql.exe 1> \\127.0.0.1\ADMIN$\__1636727589.6007507 2>&1
		$C2 = "cmd.exe /Q /c move" ascii
    //cmd /c start regsvr32 /s /i ..\\<filename>  & start cmd /c \"ping localhost -n 7 & wevtutil cl System\".
		$C2 = "ping localhost -n 7 & wevtutil cl System" ascii
	condition:
		any of them
 }
